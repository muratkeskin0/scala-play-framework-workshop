# Database configuration is loaded from database.conf
include "database.conf"
# Database configuration is loaded from database.conf example
# include "database.conf.example"

# Email configuration is loaded from email.conf
include "email.conf"
# Email configuration example
# include "email.conf.example"

# Pac4j security configuration
pac4j {
  # Security filter configuration
  securityFilter {
    # Default security clients
    defaultSecurityClients = "FormClient"
    
    # Protected URLs (require authentication)
    protectedUrls = [
      "/taskList",
      "/modern-task-list", 
      "/profile",
      "/addTask",
      "/updateTask",
      "/deleteTask",
      "/updateProfile",
      "/changePassword",
      "/admin/*"
    ]
    
    # Public URLs (no authentication required)
    publicUrls = [
      "/",
      "/login",
      "/signUp",
      "/assets/*",
      "/callback"
    ]
  }
  
  # Form client configuration
  formClient {
    loginUrl = "/login"
    usernameParameter = "email"
    passwordParameter = "password"
  }
  
  # Session store configuration
  sessionStore {
    # Use Play session store
    store = "org.pac4j.play.store.PlayCacheSessionStore"
  }
  
  # Security filter settings
  filter {
    # Enable security filter
    enabled = true
    
    # Log security events
    logging.enabled = true
  }
}

# Cache module configuration
play.modules.enabled += "play.api.cache.caffeine.CaffeineCacheModule"

# Pac4j Security Filter Configuration
play.filters.enabled += "org.pac4j.play.filters.SecurityFilter"

# CSRF Filter Configuration - Keep enabled for security
play.filters.csrf {
  # Allow AJAX requests with proper headers
  bypassCorsTrustedOrigins = false
  
  # Token name
  token.name = "csrfToken"
  
  # Token size
  token.size = 32
  
  # Bypass CSRF for specific paths
  bypass.paths = [
    "/api/*",
    "/login"
  ]
  
  # Cookie settings
  cookie {
    name = "CSRF_TOKEN"
    secure = false
    httpOnly = false
    sameSite = "lax"
  }
}

# Enable the SecurityConfigModule
play.modules.enabled += "modules.SecurityConfigModule"

# Session Configuration
play.http.session {
  # Session timeout (30 minutes)
  maxAge = 1800s
  
  # HTTP only session cookies (security)
  httpOnly = true
  
  # Secure cookies (set to false for development, true for production)
  secure = false
  
  # SameSite setting
  sameSite = "lax"
  
  # Cookie path
  path = "/"
  
  # Domain (leave empty for current domain)
  domain = null
}

# Pac4j specific configuration
pac4j {
  # Session store settings
  sessionStore {
    timeout = 1800
  }
  
  # Security filter settings
  filter {
    # Enable security filter
    enabled = true
    
    # Log security events
    logging.enabled = true
    
    # Session security
    session {
      # Secure session cookies
      secure = false
      httpOnly = true
      sameSite = "lax"
    }
  }
  
  # Debug logging
  debug = true
}